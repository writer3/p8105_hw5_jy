---
title: "HW 5"
output: github_document
---

```{r}
library(tidyverse)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```


Load key packages

```{r}
library(tidyverse)
set.seed(1000)
```

## Problem 1

Writing a function that for a fixed group size randomly draws “birthdays” for each person, checks whether there are duplicate birthdays in the group, and returns TRUE or FALSE based on the result.

```{r}
bday_sim = function(n) {
  
  bdays = sample(1:365, size = n, replace = TRUE)
  
  duplicate = length(unique(bdays)) < n #check for any duplicates, and FALSE if <n
  
  return(duplicate)
  
}

bday_sim(30)

```


Iterating 10000 times for each group size between 2 and 50. Then, for each group size, computing the probability that at least two people in the group will share a birthday by averaging across the 10000 simulation runs. 

```{r}
sim_res = 
  expand_grid(
    n = c(2:50),
    iter = 1:10000
  ) |> 
  mutate(res = map_lgl(n, bday_sim)) |>  #mutate, map across n sample size, can use map_lgl here since we know the function would result in TRUE or FALSE
  group_by(n) |> 
    summarize(prob = mean(res))
```


Making a plot showing the probability as a function of group size.

```{r}
sim_res |> 
  ggplot(aes(x = n, y = prob )) +
  geom_line()
```

The shape of the function is a sigmoid function. Larger the group size, higher the probability of at least two people in a group sharing a same birthday. 



## Problem 3

Describe the raw data. Create a city_state variable (e.g. “Baltimore, MD”) and then summarize within cities to obtain the total number of homicides and the number of unsolved homicides (those for which the disposition is “Closed without arrest” or “Open/No arrest”).

Creating a `city_state` variable, tidying, and summarizing within cities to obtain the total number of homicides and the number of unsolved homicides. 


```{r}
homicide_df = 
  read_csv("data/homicide-data.csv", na = c("", "NA", "Unknown")) |> 
  mutate(
    city_state = str_c(city, state, sep = ", ")
  )
```



